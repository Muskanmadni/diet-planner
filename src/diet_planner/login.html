<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NutriGuide - Login</title>

    <style>
        * {margin:0;padding:0;box-sizing:border-box;}
        body {
            font-family:Arial,sans-serif;
            background:linear-gradient(135deg,#4CAF50,#45a049);
            color:#333;line-height:1.6;
            min-height:100vh;
            display:flex;justify-content:center;align-items:center;
            padding:20px;
        }
        .container {max-width:500px;width:100%;background:#fff;border-radius:10px;
            box-shadow:0 10px 20px rgba(0,0,0,.2);overflow:hidden;}
        .header {background:#4CAF50;color:#fff;padding:25px;text-align:center;}
        .header h1 {margin:0;font-size:1.8rem;}
        .form-container {padding:30px;}
        .form-group {margin-bottom:20px;}
        .form-group label {display:block;margin-bottom:8px;font-weight:bold;color:#555;}
        .form-group input {
            width:100%;padding:12px;border:1px solid #ddd;border-radius:5px;
            font-size:16px;transition:border-color .3s;
        }
        .form-group input:focus {
            outline:none;border-color:#4CAF50;
            box-shadow:0 0 5px rgba(76,175,80,.3);
        }
        .btn {
            width:100%;padding:14px;background:#4CAF50;color:#fff;
            border:none;border-radius:5px;font-size:16px;cursor:pointer;
            transition:background .3s;
        }
        .btn:hover {background:#45a049;}
        .btn:active {transform:translateY(1px);}
        .register-link {text-align:center;margin-top:20px;}
        .register-link a {color:#4CAF50;text-decoration:none;font-weight:bold;}
        .register-link a:hover {text-decoration:underline;}
        .error-message {color:#d32f2f;margin-top:5px;font-size:14px;}
        .divider {text-align:center;margin:20px 0;position:relative;color:#888;}
        .divider::before {
            content:'';position:absolute;top:50%;left:0;right:0;height:1px;
            background:#ddd;
        }
        .divider span {background:#fff;padding:0 1rem;}
        .auth0-btn {
            display:block;width:100%;padding:12px;background:#eb4d4b;
            color:#fff;text-align:center;border-radius:5px;
            text-decoration:none;font-weight:600;transition:background .3s;
        }
        .auth0-btn:hover {background:#c44543;}
        @media (max-width:600px){
            .container{margin:10px;}
            .form-container{padding:20px;}
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <img src="/static/images/logo(2).png" alt="NutriGuide Logo"
                 style="height:30px;margin:0 auto 10px;display:block;">
            <p style="margin:0 0 5px 0;font-size:1.2rem;">NUTRIGUIDE</p>
            <h1 style="margin:5px 0;">Login to Your Account</h1>
            <p style="margin:5px 0 0 0;font-size:0.9rem;">Welcome Back to Smart Diet Planner</p>
        </div>

        <div class="form-container">

            <!-- Email / Password form -->
            <form id="loginForm">
                <div class="form-group">
                    <label for="email">Email Address</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <div class="form-group">
                    <label for="password">Password</label>
                    <input type="password" id="password" name="password" required>
                </div>

                <button type="submit" class="btn">Login with Email & Password</button>
            </form>

            <!-- Divider -->
            <div class="divider"><span>OR</span></div>

            <!-- Auth0 Universal Login (Google, Apple, Email, etc.) -->
            <a href="/auth0/login" class="auth0-btn">
                Continue with Google / Email
            </a>

            <div class="register-link">
                <p>Don't have an account? <a href="/register">Register here</a></p>
            </div>
        </div>
    </div>

    <script>
        // ---------- Email/Password login ----------
        document.getElementById('loginForm').addEventListener('submit', async e => {
            e.preventDefault();

            const email = document.getElementById('email').value.trim();
            const password = document.getElementById('password').value;

            try {
                const res = await fetch('/api/login', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ email, password })
                });

                const data = await res.json();

                if (res.ok) {
                    window.location.href = '/dashboard';
                } else {
                    alert('Login failed: ' + (data.error || 'Unknown error'));
                }
            } catch (err) {
                console.error(err);
                alert('Network error â€“ please try again.');
            }
        });
    </script>
</body>
</html>